<!DOCTYPE html>
<html data-theme="abyss" lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>{% block title %}Nav-Fi{% endblock %}</title>
    
    <link rel="icon" href="{{ asset('img/favicon.ico') }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ asset('img/favicon-16.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ asset('img/favicon-32.png') }}">
    <link rel="icon" type="image/png" sizes="48x48" href="{{ asset('img/favicon-48.png') }}">
    <link rel="icon" type="image/png" sizes="64x64" href="{{ asset('img/favicon-64.png') }}">
    <link rel="icon" type="image/png" sizes="128x128" href="{{ asset('img/favicon-128.png') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ asset('img/apple-touch-icon.png') }}">
    <link rel="icon" type="image/png" sizes="192x192" href="{{ asset('img/android-chrome-192.png') }}">
    <link rel="icon" type="image/png" sizes="512x512" href="{{ asset('img/android-chrome-512.png') }}">
    <link rel="shortcut icon" href="{{ asset('img/favicon.ico') }}">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">

    {% block stylesheets %}
    {% endblock %}

    {% block javascripts %}
        <script src="{{ asset('vendor/highlightjs/highlight.min.js') }}" defer></script>
        {% block importmap %}{{ importmap('app') }}{% endblock %}
    {% endblock %}
</head>
<body class="text-slate-300">

    <div class="drawer lg:drawer-open">
        <input id="my-drawer-4" type="checkbox" class="drawer-toggle"/>

        <!-- CONTENUTO PAGINA -->
        <div class="drawer-content flex flex-col min-h-screen">
            <nav class="navbar w-full sticky top-0 z-30 bg-slate-950/80 backdrop-blur-md border-b border-cyan-500/20 shadow-[0_8px_32px_rgba(0,0,0,0.4)] px-4">
                <div class="absolute bottom-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-cyan-500/50 to-transparent opacity-50"></div>
                
                <!-- BOOT SEQUENCE // CONNECTIVITY -->
                <div class="hidden xl:flex absolute left-1/2 -translate-x-1/2 top-0 h-1 px-4 gap-1">
                    <div class="w-8 h-full bg-cyan-500/20 rounded-b anime-pulse"></div>
                    <div class="w-12 h-full bg-cyan-500/40 rounded-b animate-pulse"></div>
                    <div class="w-8 h-full bg-cyan-500/20 rounded-b animate-pulse"></div>
                </div>

                <!-- MOBILE TOGGLE -->
                <div class="flex-none lg:hidden">
                    <label for="my-drawer-4"
                           aria-label="open sidebar"
                           class="btn btn-square btn-ghost text-cyan-400 hover:bg-cyan-500/10">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" fill="none" stroke="currentColor" class="size-6">
                            <path d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </label>
                </div>

                <!-- BRANDING // TELEMETRY -->
                <div class="flex items-center gap-4">
                    <div class="relative group">
                        <div class="absolute -inset-1 bg-cyan-500/20 rounded-lg blur opacity-0 group-hover:opacity-100 transition duration-500"></div>
                        <img src="{{ asset('img/nav-fi-logo.png') }}" class="relative w-12 md:w-16 h-auto filter drop-shadow-[0_0_8px_rgba(34,211,238,0.5)]" alt="logo">
                    </div>
                    <div class="flex flex-col">
                        <div class="flex items-center gap-2">
                            <span class="text-2xl md:text-3xl font-orbitron font-bold tracking-tight text-white italic">Nav-Fi</span>
                            <div class="hidden lg:flex items-center gap-2 px-3 rounded-md bg-cyan-500/10 border border-cyan-500/30 ml-2">
                                <div class="flex gap-1">
                                    <div class="w-1 h-1 rounded-full bg-cyan-500 animate-pulse"></div>
                                    <div class="w-1 h-1 rounded-full bg-cyan-400 animate-pulse" style="animation-delay: 0.2s;"></div>
                                    <div class="w-1 h-1 rounded-full bg-cyan-500 animate-pulse" style="animation-delay: 0.4s;"></div>
                                </div>
                                <span class="text-[10px] font-rajdhani uppercase tracking-[0.2em] text-cyan-400 font-bold">Imperial Standard</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-2 text-[11px] font-mono text-cyan-500/60 uppercase tracking-[0.2em] font-bold">
                            <span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                            Central Systems // Bridge Interface
                        </div>
                    </div>
                </div>

                <div class="flex-1"></div>

                <!-- USER HUD // AUTHENTICATION -->
                <div class="flex-none">
                    {% if app.user %}
                        <div class="flex items-center gap-4 bg-slate-900/40 border border-slate-800 rounded-full pl-1.5 pr-5 py-1.5 hover:border-cyan-500/30 transition-colors">
                            <div class="relative">
                                <img src="{{ app.user.gravatarUrl(48) }}"
                                     alt="avatar"
                                     class="w-10 h-10 rounded-full border border-cyan-500/40 shadow-[0_0_15px_rgba(6,182,212,0.4)]">
                                <div class="absolute -bottom-0.5 -right-0.5 w-3.5 h-3.5 bg-emerald-500 border-2 border-slate-950 rounded-full"></div>
                            </div>
                            
                            <div class="hidden md:flex flex-col items-start leading-none gap-1">
                                <span class="text-xs md:text-sm font-mono font-bold text-cyan-100 uppercase tracking-widest">{{ app.user.userIdentifier }}</span>
                                <div class="flex items-center gap-1.5">
                                    {% if is_granted('ROLE_SUPER_ADMIN') %}
                                        <span class="text-[10px] font-mono font-bold text-rose-500 uppercase tracking-tighter bg-rose-500/10 px-2 py-0.5 border border-rose-500/20">OVERRIDE_AUTH</span>
                                    {% elseif is_granted('ROLE_ADMIN') %}
                                        <span class="text-[10px] font-mono font-bold text-amber-500 uppercase tracking-tighter bg-amber-500/10 px-2 py-0.5 border border-amber-500/20">ELEVATED_AUTH</span>
                                    {% else %}
                                        <span class="text-[10px] font-mono font-bold text-cyan-500 uppercase tracking-tighter bg-cyan-500/10 px-2 py-0.5 border border-cyan-500/20">STAND_USER</span>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="w-[1px] h-8 bg-slate-800 mx-1"></div>

                            <form method="post" action="{{ path('app_logout') }}">
                                <button class="group flex items-center gap-2.5 px-2.5 py-1.5 rounded-md hover:bg-rose-500/10 transition-all">
                                    <span class="hidden sm:inline text-[11px] font-orbitron font-bold text-slate-500 group-hover:text-rose-400 tracking-widest uppercase transition-colors">Eject</span>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" class="text-slate-500 group-hover:text-rose-500 transition-colors">
                                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9"/>
                                    </svg>
                                </button>
                            </form>
                        </div>
                    {% else %}
                        <a href="{{ path('app_login') }}" class="btn btn-outline border-cyan-500/40 text-cyan-400 font-orbitron uppercase tracking-widest text-[11px] hover:bg-cyan-500/10 hover:border-cyan-400 px-6">
                            Establish Link // Login
                        </a>
                    {% endif %}
                </div>
            </nav>

            <div class="p-6">
                <div class="w-full">
                    <div class="flex flex-col items-stretch gap-4">
                        {% for label, messages in app.flashes %}
                            <fieldset class="fieldset bg-base-200 border-base-300 gap-4 p-4 border rounded w-full">
                                {% for message in messages %}
                                    <div role="alert" class="alert alert-{{ label }} alert-outline w-full">
                                        <div class="animate-spin-slow text-current">
                                            {% include 'icons/radar.html.twig' with { dim: 24 } %}
                                        </div>
                                        <div>{{ message }}</div>
                                    </div>
                                {% endfor %}
                            </fieldset>
                        {% endfor %}
                    </div>

                    {% block pageContent %}{% endblock %}
                </div>
            </div>

            <footer class="footer sm:footer-horizontal footer-center bg-neutral text-base-content p-4 sticky top-[100vh]">
                <aside class="text-sm uppercase tracking-[0.25em] text-slate-200/80">
                    <div class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="size-5 opacity-80">
                            <path d="M3 12h18"></path>
                            <path d="M8 7l-2 5 2 5"></path>
                            <path d="M16 7l2 5-2 5"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        <span>Nav-Fi // Imperial drift lane</span>
                    </div>
                </aside>
            </footer>

        </div>

        <!-- SIDEBAR -->
        {% include '_sidebar.html.twig' %}
    </div>

</body>
</html>
