{% extends 'base.html.twig' %}
{% import '_tooltip.html.twig' as tooltip %}

{% block title %}Nav-Fi&sup3; - Companies{% endblock %}

{% block pageContent %}

    <div class="">

    {% embed 'components/_hero_header.html.twig' with {
        icon: 'icons/company.html.twig',
        theme: 'cyan',
        subheader: 'Partners Registry',
        title: 'COMPANIES',
        description: 'Counterparties, roles and contacts ready for contracts and documents.'
    } %}
        {% import '_tooltip.html.twig' as tooltip %}
        {% block actions %}
            {{ tooltip.link('Register counterparty',
                            'Add company',
                            'icons/company.html.twig',
                            path('app_company_new'),
                            { dim: 24, linkClass: 'btn btn-outline btn-primary btn-sm gap-2 font-orbitron text-[10px] tracking-widest uppercase' }) }}
        {% endblock %}
    {% endembed %}



        {% set filter_fields %}
            <div>
                <label class="label text-xs uppercase tracking-[0.2em] text-slate-400">Name</label>
                <input type="text" name="name" value="{{ filters.name }}" class="input m-1 w-full">
            </div>
            <div>
                <label class="label text-xs uppercase tracking-[0.2em] text-slate-400">Role</label>
                <select name="role" class="select m-1 w-full">
                    <option value="">All roles</option>
                    {% for role in roles %}
                        <option value="{{ role.id }}" {% if filters.role == role.id %}selected{% endif %}>
                            {{ role.shortDescription ?? role.code }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label class="label text-xs uppercase tracking-[0.2em] text-slate-400">Contact</label>
                <input type="text" name="contact" value="{{ filters.contact }}" class="input m-1 w-full">
            </div>
        {% endset %}
        {% include 'components/index_filters.html.twig' with {
            form_id: 'company-filters',
            action: path('app_company_index'),
            legend: 'Company search',
            grid_class: 'md:grid-cols-3',
            fields: filter_fields,
            reset_path: path('app_company_index'),
            is_filtered: filters.name or filters.role or filters.contact
        } %}

        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 mb-8">
            {% if companies|length > 0 %}
                {% for company in companies %}
                    <twig:TacticalCompanyCard :company="company" />
                {% endfor %}
            {% else %}
                <div class="col-span-full py-20 flex flex-col items-center justify-center rounded-xl border border-dashed border-slate-700 bg-slate-900/50">
                    <div class="text-slate-500 mb-2">{% include 'icons/company.html.twig' with {'dim': 48} %}</div>
                    <p class="text-slate-400 uppercase tracking-widest text-sm mb-6">Registry is empty // No partners detected</p>
                    <a href="{{ path('app_company_new') }}" class="text-cyan-400 hover:text-cyan-300 text-xs font-bold uppercase underline underline-offset-4 decoration-cyan-500/30 transition-colors">Initialize Registry</a>
                </div>
            {% endif %}
        </div>

            {% include 'components/pagination.html.twig' with {
                pagination: pagination,
                route: 'app_company_index',
                query: app.request.query.all
            } %}

    </div>

{% endblock %}
