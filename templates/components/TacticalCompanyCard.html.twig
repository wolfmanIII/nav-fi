{% props company %}

<twig:TacticalContainer>
    {% import '_tooltip.html.twig' as tooltip %}
    {# Card Header: Actions & REF #}
    <div class="flex items-center justify-between mb-4">
        <div class="flex items-center gap-2">
            <div class="px-2 py-1 rounded border border-slate-700 bg-slate-800 text-xs font-mono tracking-widest text-slate-400 uppercase">
                {% include 'components/code_with_copy.html.twig' with { code: company.code } %}
            </div>
        </div>
        <div class="flex items-center gap-1">
            {{ tooltip.link('Update counterparty', '', 'icons/action-edit.html.twig', path('app_company_edit', {id: company.id}), { dim: 16, linkClass: 'p-2 rounded-lg hover:bg-emerald-500/20 text-slate-400 hover:text-emerald-400' }) }}
            {% set can_delete = is_granted('COMPANY_DELETE', company) %}
            {{ tooltip.link('Retire counterparty', '', 'icons/action-trash.html.twig', path('app_company_delete', {id: company.id}), {
                dim: 16,
                linkClass: 'p-2 rounded-lg hover:bg-red-500/20 text-red-400' ~ (can_delete ? '' : ' opacity-50 pointer-events-none'),
                attrs: {
                    'data-turbo-method': 'post',
                    'data-turbo-confirm': 'Are you sure you want to retire this counterparty? Active contracts and financial relations will be flagged.',
                    'data-confirm-title': 'Retire Counterparty?',
                    'data-confirm-type': 'danger',
                    'data-confirm-text': 'Retire',
                    'data-confirm-cancel': 'Keep Active'
                }
            }) }}
        </div>
    </div>

    {# Card Body: Identity #}
    <div class="mb-4">
        <h2 class="text-2xl font-bold text-slate-200 group-hover:text-emerald-400 transition-colors uppercase tracking-tight font-orbitron truncate" title="{{ company.name }}">
            {{ company.name }}
        </h2>
        {% if company.signLabel %}
            <p class="text-sm font-medium text-slate-500 font-rajdhani tracking-widest uppercase">
                // SIGN: {{ company.signLabel }}
            </p>
        {% endif %}
    </div>

    {# Card Detail: Role #}
    <div class="flex flex-wrap gap-2 mb-6">
        <span class="px-2 py-0.5 rounded-full bg-slate-800/80 border border-slate-700 text-[10px] font-bold text-slate-300 uppercase tracking-wider font-rajdhani">
            {{ company.companyRole.description }}
        </span>
    </div>

    {# Card Footer: Contact #}
    <div class="mt-auto pt-4 border-t border-slate-800 flex flex-col gap-2">
        <div class="flex items-center justify-between text-xs font-rajdhani tracking-wider">
            <span class="text-slate-500 uppercase">Contact</span>
            <span class="text-slate-300 font-bold uppercase truncate max-w-[150px]" title="{{ company.contact ?? 'N/A' }}">
                {{ company.contact ?? '<span class="text-slate-600">N/A</span>' }}
            </span>
        </div>
    </div>
</twig:TacticalContainer>
