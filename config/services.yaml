# Questo file è il punto di ingresso per configurare i tuoi servizi.
# I file nella sottocartella packages/ configurano le tue dipendenze.

# Metti qui i parametri che non devono cambiare su ogni macchina dove l'app è deployata
# https://symfony.com/doc/current/best_practices.html#use-parameters-for-application-configuration
parameters:
    app.day_min: "%env(int:APP_DAY_MIN)%"
    app.day_max: "%env(int:APP_DAY_MAX)%"
    app.year_min: "%env(int:APP_YEAR_MIN)%"
    app.year_max: "%env(int:APP_YEAR_MAX)%"
    ai.backend: "%env(AI_BACKEND)%" # ollama | openai

services:
    # configurazione di default per i servizi in *questo* file
    _defaults:
        autowire: true # Inietta automaticamente le dipendenze nei tuoi servizi.
        autoconfigure: true # Registra automaticamente i tuoi servizi come comandi, event subscriber, ecc.

    # rende le classi in src/ disponibili per essere usate come servizi
    # crea un servizio per classe il cui id è il nome della classe fully-qualified
    App\:
        resource: "../src/"

    App\Form\Config\DayYearLimits:
        arguments:
            $dayMin: "%app.day_min%"
            $dayMax: "%app.day_max%"
            $yearMin: "%app.year_min%"
            $yearMax: "%app.year_max%"

    App\Form\Type\ImperialDateType:
        arguments:
            $minYear: "%app.year_min%"
            $maxYear: "%app.year_max%"
            $minDay: "%app.day_min%"
            $maxDay: "%app.day_max%"

    App\Service\TemplateVersionRegistry:
        arguments:
            $projectDir: "%kernel.project_dir%"

    # aggiungi definizioni di servizi quando è necessaria una configurazione esplicita
    # nota che le ultime definizioni *rimpiazzano* sempre quelle precedenti

    # Abilita i foreign keys su TUTTE le connessioni SQLite
    #Doctrine\DBAL\Driver\AbstractSQLiteDriver\Middleware\EnableForeignKeys:
    #   tags:
    #       - { name: 'doctrine.middleware' }

    App\EventSubscriber\AssignUserSubscriber:
        tags: ["doctrine.event_subscriber"]

    # Fix per il controller SchebTwoFactorBundle che non è public/auto-wired
    Scheb\TwoFactorBundle\Controller\FormController:
        alias: scheb_two_factor.form_controller
        public: true
